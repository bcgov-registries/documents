<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="414px" preserveAspectRatio="none" style="width:717px;height:414px;background:#FFFFFF;" version="1.1" viewBox="0 0 717 414" width="717px" zoomAndPan="magnify"><defs><filter height="300%" id="f1muue5wpywaun" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1muue5wpywaun)" height="237.4395" style="stroke:#000000;stroke-width:2.0;" width="693" x="10" y="116.1094"/><rect fill="#FFFFFF" height="190.8184" style="stroke:none;stroke-width:1.0;" width="693" x="10" y="162.7305"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="104" x2="104" y1="40.4883" y2="370.5488"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="226" x2="226" y1="40.4883" y2="370.5488"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="354" x2="354" y1="40.4883" y2="370.5488"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="457" x2="457" y1="40.4883" y2="370.5488"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="598" x2="598" y1="40.4883" y2="370.5488"/><path d="M25,14 L183,14 C188,14 188,27.2441 188,27.2441 C188,27.2441 188,40.4883 183,40.4883 L25,40.4883 C20,40.4883 20,27.2441 20,27.2441 C20,27.2441 20,14 25,14 " fill="#FEFECE" filter="url(#f1muue5wpywaun)" style="stroke:#A80036;stroke-width:2.0;"/><path d="M183,14 C178,14 178,27.2441 178,27.2441 C178,40.4883 183,40.4883 183,40.4883 " fill="none" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="148" x="25" y="32.5352">Reconciliation_Queue</text><path d="M25,369.5488 L183,369.5488 C188,369.5488 188,382.793 188,382.793 C188,382.793 188,396.0371 183,396.0371 L25,396.0371 C20,396.0371 20,382.793 20,382.793 C20,382.793 20,369.5488 25,369.5488 " fill="#FEFECE" filter="url(#f1muue5wpywaun)" style="stroke:#A80036;stroke-width:2.0;"/><path d="M183,369.5488 C178,369.5488 178,382.793 178,382.793 C178,396.0371 183,396.0371 183,396.0371 " fill="none" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="148" x="25" y="388.084">Reconciliation_Queue</text><rect fill="#FEFECE" filter="url(#f1muue5wpywaun)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="52" x="198" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="205" y="25.5352">Minio</text><rect fill="#FEFECE" filter="url(#f1muue5wpywaun)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="52" x="198" y="369.5488"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="205" y="390.084">Minio</text><path d="M302,14 L406,14 C411,14 411,27.2441 411,27.2441 C411,27.2441 411,40.4883 406,40.4883 L302,40.4883 C297,40.4883 297,27.2441 297,27.2441 C297,27.2441 297,14 302,14 " fill="#FEFECE" filter="url(#f1muue5wpywaun)" style="stroke:#A80036;stroke-width:2.0;"/><path d="M406,14 C401,14 401,27.2441 401,27.2441 C401,40.4883 406,40.4883 406,40.4883 " fill="none" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94" x="302" y="32.5352">Mailer_Queue</text><path d="M302,369.5488 L406,369.5488 C411,369.5488 411,382.793 411,382.793 C411,382.793 411,396.0371 406,396.0371 L302,396.0371 C297,396.0371 297,382.793 297,382.793 C297,382.793 297,369.5488 302,369.5488 " fill="#FEFECE" filter="url(#f1muue5wpywaun)" style="stroke:#A80036;stroke-width:2.0;"/><path d="M406,369.5488 C401,369.5488 401,382.793 401,382.793 C401,396.0371 406,396.0371 406,396.0371 " fill="none" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94" x="302" y="388.084">Mailer_Queue</text><rect fill="#FEFECE" filter="url(#f1muue5wpywaun)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="69" x="421" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="428" y="25.5352">CFS_API</text><rect fill="#FEFECE" filter="url(#f1muue5wpywaun)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="69" x="421" y="369.5488"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="428" y="390.084">CFS_API</text><path d="M509,14 L688,14 C693,14 693,27.2441 693,27.2441 C693,27.2441 693,40.4883 688,40.4883 L509,40.4883 C504,40.4883 504,27.2441 504,27.2441 C504,27.2441 504,14 509,14 " fill="#FEFECE" filter="url(#f1muue5wpywaun)" style="stroke:#A80036;stroke-width:2.0;"/><path d="M688,14 C683,14 683,27.2441 683,27.2441 C683,40.4883 688,40.4883 688,40.4883 " fill="none" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="169" x="509" y="32.5352">Account_Listener_Queue</text><path d="M509,369.5488 L688,369.5488 C693,369.5488 693,382.793 693,382.793 C693,382.793 693,396.0371 688,396.0371 L509,396.0371 C504,396.0371 504,382.793 504,382.793 C504,382.793 504,369.5488 509,369.5488 " fill="#FEFECE" filter="url(#f1muue5wpywaun)" style="stroke:#A80036;stroke-width:2.0;"/><path d="M688,369.5488 C683,369.5488 683,382.793 683,382.793 C683,396.0371 688,396.0371 688,396.0371 " fill="none" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="169" x="509" y="388.084">Account_Listener_Queue</text><polygon fill="#A80036" points="214,67.7988,224,71.7988,214,75.7988,218,71.7988" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="104" x2="220" y1="71.7988" y2="71.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="111" y="67.0566">Get the file</text><polygon fill="#A80036" points="115,97.1094,105,101.1094,115,105.1094,111,101.1094" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="109" x2="225" y1="101.1094" y2="101.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="121" y="96.3672">File content</text><path d="M10,116.1094 L72,116.1094 L72,123.1094 L62,133.1094 L10,133.1094 L10,116.1094 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="237.4395" style="stroke:#000000;stroke-width:2.0;" width="693" x="10" y="116.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="25" y="129.6777">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="118" x="87" y="128.7441">[Successful Payment]</text><polygon fill="#A80036" points="342,150.7305,352,154.7305,342,158.7305,346,154.7305" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="104" x2="348" y1="154.7305" y2="154.7305"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226" x="111" y="149.9883">Publish PAD payment success event</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="703" y1="163.7305" y2="163.7305"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="92" x="15" y="174.3652">[Failed Payment]</text><polygon fill="#A80036" points="445.5,194.9961,455.5,198.9961,445.5,202.9961,449.5,198.9961" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="104" x2="451.5" y1="198.9961" y2="198.9961"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="111" y="194.2539">Suspend /sites</text><polygon fill="#A80036" points="115,224.3066,105,228.3066,115,232.3066,111,228.3066" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="109" x2="456.5" y1="228.3066" y2="228.3066"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="121" y="223.5645">Suspend site response</text><polygon fill="#A80036" points="445.5,253.6172,455.5,257.6172,445.5,261.6172,449.5,257.6172" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="104" x2="451.5" y1="257.6172" y2="257.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="111" y="252.875">/invs/adjs</text><polygon fill="#A80036" points="115,282.9277,105,286.9277,115,290.9277,111,286.9277" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="109" x2="456.5" y1="286.9277" y2="286.9277"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="121" y="282.1855">Adjustment response for NSF fees</text><polygon fill="#A80036" points="586.5,312.2383,596.5,316.2383,586.5,320.2383,590.5,316.2383" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="104" x2="592.5" y1="316.2383" y2="316.2383"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="111" y="311.4961">Publish lockAccount message</text><polygon fill="#A80036" points="342,341.5488,352,345.5488,342,349.5488,346,345.5488" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="104" x2="348" y1="345.5488" y2="345.5488"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216" x="111" y="340.8066">Publish PAD payment failure event</text><!--MD5=[f8fc63e7a6d8ffd9d7233f0c792e5fce]
@startuml pad/pad_reconciliation
queue       Reconciliation_Queue
participant Minio
queue       Mailer_Queue
participant CFS_API
queue       Account_Listener_Queue


Reconciliation_Queue -> Minio: Get the file
Minio -> Reconciliation_Queue: File content
alt Successful Payment
    Reconciliation_Queue -> Mailer_Queue : Publish PAD payment success event

else Failed Payment
    Reconciliation_Queue -> CFS_API: Suspend /sites
    CFS_API -> Reconciliation_Queue: Suspend site response
    Reconciliation_Queue -> CFS_API: /invs/adjs
    CFS_API -> Reconciliation_Queue: Adjustment response for NSF fees
    Reconciliation_Queue -> Account_Listener_Queue : Publish lockAccount message
    Reconciliation_Queue -> Mailer_Queue : Publish PAD payment failure event

end

@enduml

PlantUML version 1.2021.14(Fri Nov 12 08:46:50 PST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: CA
--></g></svg>