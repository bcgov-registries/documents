<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="529px" preserveAspectRatio="none" style="width:969px;height:529px;background:#FFFFFF;" version="1.1" viewBox="0 0 969 529" width="969px" zoomAndPan="magnify"><defs><filter height="300%" id="f1wdofuxclho5p" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1wdofuxclho5p)" height="176.8633" style="stroke:#000000;stroke-width:2.0;" width="448.5" x="254.5" y="86.7988"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="48" x2="48" y1="40.4883" y2="485.8359"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="299.5" x2="299.5" y1="40.4883" y2="485.8359"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="656" x2="656" y1="40.4883" y2="485.8359"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="732" x2="732" y1="40.4883" y2="485.8359"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="865" x2="865" y1="40.4883" y2="485.8359"/><rect fill="#FEFECE" filter="url(#f1wdofuxclho5p)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="83" x="5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="12" y="25.5352">Auth_Web</text><rect fill="#FEFECE" filter="url(#f1wdofuxclho5p)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="83" x="5" y="484.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69" x="12" y="505.3711">Auth_Web</text><rect fill="#FEFECE" filter="url(#f1wdofuxclho5p)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="66" x="264.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52" x="271.5" y="25.5352">Pay_API</text><rect fill="#FEFECE" filter="url(#f1wdofuxclho5p)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="66" x="264.5" y="484.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52" x="271.5" y="505.3711">Pay_API</text><rect fill="#FEFECE" filter="url(#f1wdofuxclho5p)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="69" x="620" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="627" y="25.5352">CFS_API</text><rect fill="#FEFECE" filter="url(#f1wdofuxclho5p)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="69" x="620" y="484.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="627" y="505.3711">CFS_API</text><rect fill="#FEFECE" filter="url(#f1wdofuxclho5p)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="55" x="703" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="710" y="25.5352">PayBC</text><rect fill="#FEFECE" filter="url(#f1wdofuxclho5p)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="55" x="703" y="484.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="710" y="505.3711">PayBC</text><rect fill="#FEFECE" filter="url(#f1wdofuxclho5p)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="183" x="772" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="169" x="779" y="25.5352">Account_Listener_Queue</text><rect fill="#FEFECE" filter="url(#f1wdofuxclho5p)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="183" x="772" y="484.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="169" x="779" y="505.3711">Account_Listener_Queue</text><polygon fill="#A80036" points="287.5,67.7988,297.5,71.7988,287.5,75.7988,291.5,71.7988" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="48.5" x2="293.5" y1="71.7988" y2="71.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227" x="55.5" y="67.0566">/payments?retryFailedPayment=true</text><path d="M254.5,86.7988 L316.5,86.7988 L316.5,93.7988 L306.5,103.7988 L254.5,103.7988 L254.5,86.7988 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="176.8633" style="stroke:#000000;stroke-width:2.0;" width="448.5" x="254.5" y="86.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="269.5" y="100.3672">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="72" x="331.5" y="99.4336">[consolidate]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="299.5" x2="341.5" y1="125.4199" y2="125.4199"/><line style="stroke:#A80036;stroke-width:1.0;" x1="341.5" x2="341.5" y1="125.4199" y2="138.4199"/><line style="stroke:#A80036;stroke-width:1.0;" x1="300.5" x2="341.5" y1="138.4199" y2="138.4199"/><polygon fill="#A80036" points="310.5,134.4199,300.5,138.4199,310.5,142.4199,306.5,138.4199" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="343" x="306.5" y="120.6777">consolidate invoice if more than one FAILED payments</text><polygon fill="#A80036" points="644.5,163.7305,654.5,167.7305,644.5,171.7305,648.5,167.7305" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="299.5" x2="650.5" y1="167.7305" y2="167.7305"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="306.5" y="162.9883">/creditbalance</text><polygon fill="#A80036" points="310.5,193.041,300.5,197.041,310.5,201.041,306.5,197.041" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="304.5" x2="655.5" y1="197.041" y2="197.041"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="316.5" y="192.2988">Credit balance response</text><polygon fill="#A80036" points="644.5,222.3516,654.5,226.3516,644.5,230.3516,648.5,226.3516" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="299.5" x2="650.5" y1="226.3516" y2="226.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33" x="306.5" y="221.6094">/invs</text><polygon fill="#A80036" points="310.5,251.6621,300.5,255.6621,310.5,259.6621,306.5,255.6621" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="304.5" x2="655.5" y1="255.6621" y2="255.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193" x="316.5" y="250.9199">Consolidated invoice response</text><polygon fill="#A80036" points="59.5,287.9727,49.5,291.9727,59.5,295.9727,55.5,291.9727" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="53.5" x2="298.5" y1="291.9727" y2="291.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="65.5" y="287.2305">Failed Payment response</text><polygon fill="#A80036" points="720.5,317.2832,730.5,321.2832,720.5,325.2832,724.5,321.2832" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="48.5" x2="726.5" y1="321.2832" y2="321.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="55.5" y="316.541">Credit Card Payment</text><polygon fill="#A80036" points="59.5,346.5938,49.5,350.5938,59.5,354.5938,55.5,350.5938" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="53.5" x2="731.5" y1="350.5938" y2="350.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="65.5" y="345.8516">Successful payment</text><polygon fill="#A80036" points="287.5,375.9043,297.5,379.9043,287.5,383.9043,291.5,379.9043" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="48.5" x2="293.5" y1="379.9043" y2="379.9043"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="55.5" y="375.1621">/transactions</text><polygon fill="#A80036" points="644.5,405.2148,654.5,409.2148,644.5,413.2148,648.5,409.2148" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="299.5" x2="650.5" y1="409.2148" y2="409.2148"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="39" x="306.5" y="404.4727">/rcpts</text><polygon fill="#A80036" points="310.5,434.5254,300.5,438.5254,310.5,442.5254,306.5,438.5254" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="304.5" x2="655.5" y1="438.5254" y2="438.5254"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="316.5" y="433.7832">Invoice receipt response</text><polygon fill="#A80036" points="853.5,463.8359,863.5,467.8359,853.5,471.8359,857.5,467.8359" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="299.5" x2="859.5" y1="467.8359" y2="467.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="306.5" y="463.0938">Publish unLockAccount message</text><!--MD5=[49bad40ae4aaabb95dadf0c349141ea1]
@startuml pad/nsf

Auth_Web -> Pay_API : /payments?retryFailedPayment=true
alt consolidate
Pay_API -> Pay_API : consolidate invoice if more than one FAILED payments
Pay_API -> CFS_API: /creditbalance
CFS_API -> Pay_API: Credit balance response
Pay_API -> CFS_API: /invs
CFS_API -> Pay_API: Consolidated invoice response
end
Pay_API -> Auth_Web: Failed Payment response
Auth_Web -> PayBC : Credit Card Payment
PayBC -> Auth_Web : Successful payment

Auth_Web -> Pay_API : /transactions
Pay_API -> CFS_API : /rcpts
CFS_API -> Pay_API: Invoice receipt response
Pay_API -> Account_Listener_Queue : Publish unLockAccount message

@enduml

PlantUML version 1.2021.14(Fri Nov 12 08:46:50 PST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: CA
--></g></svg>